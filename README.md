# Сборка для верстки
![alt text](https://badgen.net/github/release/webzlodimir/gulp-template "Releases")

## Подготовка к работе

Для начала работы необходимо наличие Node.js в системе. А так же должен быть глобально установлен `gulp-cli`.
Затем устанавливаем все зависимости `npm i --save-dev` или `yarn install`

## Структура проекта

```
gulp-template
├── dist
├── gulp-tasks
├── src
│   ├── css
│   ├── fonts
│   ├── img
│   ├── js
│   ├── sass
│   ├── templates
│   └── index.html
├── package.json
├── README.md
├── gulpfile.js
├── .babelrc
├── .browserslistrc
├── .prettierrc
├── .prettierignore
└── .gitignore
```

* Корень папки:
    * ```.babelrc``` — настройки Babel
    * ```.prettierrc``` — настройки Prettier
    * ```.prettierignore``` — запрет изменения файлов Prettier
    * ```.gitignore``` – запрет на отслеживание файлов Git'ом
    * ```package.json``` — список зависимостей
    * ```README.md``` — описание проекта
    * ```gulpfile.js``` — файл конфигурации Gulp
    * ```.browserslistrc``` — файл конфигурации поддерживаемых версий браузеров
    
* Папка ```src``` - используется во время разработки:
    * ```css``` — директория для файлов css библиотек, изначально тут лежит файл сброса стилей и сетка [Bootstrap 4](https://getbootstrap.com/)
    * ```fonts``` – директория для шрифтов
    * ```img``` — директория для изображений, при работе графика оптимизируется и переносится в прод. Так же автоматически создаются WebP
    * ```js``` — директория для js библиотек. Здесь  лежит `app.js` для кастомного кода, и `ofi.min.js` - полифил для CSS-свойства `object-fit`. Туда так же можно закидывать JS библиотеки и они будут подключаться автоматически. jQuery последней версии автоматически добавляется в билд.
    * ```sass``` — директория для sass файлов
    * ```templates``` — директория для html файлов которые добавляются в проекте
    * ```index.html``` — основной html файл проекта

## Миксины и прочее
Изначально есть пара полезных миксинов:
 - `@include font-face("FuturaPT", "/fonts/FuturaPT-Book", 300);` - позволяет подключать шрифты в 1 строку.
 - `@include object-fit(cover)` - используется для полифила CSS-свойства object-fit
 - На тег `html` автоматически вешается класс `is-mac` или `is-ios` для определения устройства
 
 ## Верстка
Команды для сборки:
 - `gulp` запускает сборку и локальный сервер с Hot Reloading
 - `gulp dev` запускает сборку и на выходе получаем не минифицированные  файлы app.js и app.css
 - `gulp build` запускает сборку и на выходе получаем минифицированные файлы app.js и app.css
 
 ## Nunjucks
 В проекте для шаблонирования используется шаблонизатор [Nunjucks](https://mozilla.github.io/nunjucks/templating.html).
 
 ### Инклуды
 Для вставки одного файла в другой используется конструкция ```{% include 'templates/filename.html' %}```
 Так же перед инклудом можно обьявить переменную с помощью конструкции ```{% set varname = 'value of var' %}``` и она будет доступна ниже в добавленом файле.
 
 ### Циклы
 Циклы необходимы для вставки многих элементов сразу, или для перечисления элементов.
 ```
    {% for foo in bars %}
        {{ foo }}
    {% endfor %}
 ```

 Если необходимо вывести сразу несколько элементов определенного количества, то можно использовать функцию ```range()```
 ```
    {% for foo in range(1,3) %}
        <div>Element</div>
    {% endfor %}
 ```
 Циклы так же можно сочетать с инклудами
 ```
    {% for foo in range(1,3) %}
        {% include 'templates/filename.html' %}
    {% endfor %}
 ```

 ### Импорты
 Для переиспользования компонентов и возможности прокидывания в них параметров, используем макросы. Например создаем в ```templates``` файл ```ui.html```
 В нем мы создаем компонент кнопки.
 ```
    {% macro button(class, value='Новая кнопка', type='button', isImage) %}
    <button type="{{ type }}" class="{{ class }}">
      {{ value | escape }}
    </button>
    {% endmacro %}
 ```
 * Кнопка принимает слующие параметры:
     * ```class``` — сюда мы например прокинем класс который будет подставляться в кнопку, у него нет значения по-умолчанию, поэтому он обязателен
     * ```value``` – это текст кнопки, у него установлено значение по умолчанию "Новая кнопка"
     * ```type``` — тип кнопки, так же задано значение по умолчанию "button"
     
 После того как мы создали компоненты в этом файле, мы в верхней части файла где нам необходим этот компонент делаем его импорт:
 
 ```
    {% import "templates/components/ui.html" as ui %}
 ```

 И теперь мы можем использовать компонент в шаблоне:
 ```
    {{ ui.button('btn btn--red', 'Отправить', 'submit') }}
 ```

Это основы, с более подробной документацией можно ознакомиться выше по ссылке.